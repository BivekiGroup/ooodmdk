---
const props = Astro.props;
const items = Array.isArray(props.items) ? props.items : [];
const homeLabel = typeof props.homeLabel === "string" ? props.homeLabel : "Главная";
const ariaLabel = typeof props.ariaLabel === "string" ? props.ariaLabel : "Breadcrumbs";
const siteOrigin = Astro.locals.siteOrigin ?? `${Astro.url.protocol}//${Astro.url.host}`;
const homeHref = typeof props.homeHref === "string" ? props.homeHref : `${siteOrigin}/`;

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  itemListElement: [
    {
      "@type": "ListItem",
      position: 1,
      name: homeLabel,
      item: homeHref,
    },
    ...items.map((item, index) => ({
      "@type": "ListItem",
      position: index + 2,
      name: item.title,
      item: item.href,
    })),
  ],
};
---

<nav aria-label={ariaLabel} class="py-4 px-8 lg:px-24 header-offset">
  <ol
    class="flex flex-wrap items-center space-x-2 text-sm text-gray-600"
    itemscope
    itemtype="https://schema.org/BreadcrumbList"
  >
    <li
      class="flex items-center"
      itemprop="itemListElement"
      itemscope
      itemtype="https://schema.org/ListItem"
    >
      <a
        href={homeHref}
        class="hover:text-yellow-500 transition-colors"
        itemprop="item"
      >
        <span itemprop="name">{homeLabel}</span>
      </a>
      <meta itemprop="position" content="1" />
      <span class="mx-2">/</span>
    </li>

    {
      items.map((item, index) => (
        <li
          class="flex items-center"
          itemprop="itemListElement"
          itemscope
          itemtype="https://schema.org/ListItem"
        >
          <a
            href={item.href}
            class="hover:text-yellow-500 transition-colors"
            itemprop="item"
          >
            <span itemprop="name">{item.title}</span>
          </a>
          <meta itemprop="position" content={`${index + 2}`} />
          {index < items.length - 1 && <span class="mx-2">/</span>}
        </li>
      ))
    }
  </ol>
</nav>

<script type="application/ld+json">
  {JSON.stringify(breadcrumbSchema)}
</script>
